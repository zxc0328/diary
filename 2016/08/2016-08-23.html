<!DOCTYPE html><!--[if lte IE 8]>
<html lang="en" class="lte-ie8">
<![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en">
<!--<![endif]--><head><meta charset="utf-8"><title>August 23, 2016</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/diary/styles/global.css"><link rel="stylesheet" href="/diary/styles/tomorrow.css"><link rel="stylesheet" href="/diary/styles/diary.css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-63818301-1', 'auto');
ga('send', 'pageview');</script></head><body><header class="header"><div class="index"><a href="/diary/">Index</a></div><h1>August 23, 2016</h1></header><div class="content"><div class="diary"><h2 id="etag-last-modified-and-more-on-caching"><code>Etag</code> <code>Last-Modified</code> and more on caching</h2>
<h3 id="etag-and-last-modified"><code>Etag</code> and <code>Last-Modified</code></h3>
<p>When the client request a resource for the first time, there might be <code>Etag</code> or <code>Last-Modified</code> field (or both) in the response header.</p>
<p>When the client request that resource for the second time, the client will send a conditional requests, the <code>Etag</code> from the first request will appear as <code>If-None-Match</code>, and <code>Last-Modified</code> as <code>If-Modified-Since</code> in the request header. Client does not check the headers to see if they have changed. It just blindly uses them in the next conditional request. It is up to the server to evaluate whether to send the requested content or a 304 Not Modified response.</p>
<blockquote>
<p>According to RFC 2616 section 13.3.4, an HTTP 1.1 Client MUST use the ETag in any cache-conditional requests, and if both an ETag and Last Modified are present, it SHOULD use both.</p>
</blockquote>
<h3 id="expires-and-cache-control"><code>Expires</code> and <code>Cache-Control</code></h3>
<p>In format:</p>
<pre><code><span class="hljs-attribute">Cache-Control</span>: <span class="hljs-string">max-age=3600</span>
</code></pre><p>as opposed to</p>
<pre><code>Expires: Tue, <span class="hljs-number">15</span> May <span class="hljs-number">2007</span> <span class="hljs-number">07</span>:<span class="hljs-number">19</span>:<span class="hljs-number">00</span> GMT
</code></pre><p><code>Cache-Control</code> header was defined as part of the HTTP/1.1 specification and supersedes previous headers (e.g. <code>Expires</code>) used to define response caching policies. All modern browsers support <code>Cache-Control</code>, hence that is all we will need.</p>
<p>And since <code>Expires</code> is more error-prone, so we prefer to use <code>Cache-Control</code>.</p>
<h3 id="links">Links</h3>
<ul>
<li><a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html">Hypertext Transfer Protocol -- HTTP/1.1 -- Caching in HTTP</a></li>
<li><a href="http://stackoverflow.com/questions/824152/what-takes-precedence-the-etag-or-last-modified-http-header">What takes precedence: the ETag or Last-Modified HTTP header?</a></li>
<li><a href="https://www.mnot.net/cache_docs/">Caching Tutorial for Web Authors and Webmasters</a></li>
<li><a href="http://www.telerik.com/blogs/understanding-http-304-responses">Understanding HTTP/304 Responses</a></li>
</ul>
</div></div><footer class="footer"><address class="author">Copyright &copy;<a rel="author" href="https://github.com/joyeecheung" class="author-name">Joyee Cheung</a>-<a href="https://github.com/zxc0328/diary-content.git" class="source-repo">Source</a></address><p>Generated by<a href="https://github.com/joyeecheung/diary" class="site-repo">Joyee Cheung&#39;s diary generator</a></p></footer></body></html>